<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>
<body>

<div id="Login" hidden="hidden" >
	<form>
		<div>
		<h1>Wheels<span>BUY / SELL / RENT</span></h1>
		</div>
		<label>Email: </label>
		<input id="email" type="email"></input>
		<br/>
		<br/>
		<label>Password: </label>
		<input id="password" type="password"></input>
		<br/>
		<button class="SubBtn" type="button" onclick="Login()">Submit</button>
	</form>
</div>

</body>
<script>

function Login(){
	email = document.getElementById('email').value;
	password = document.getElementById('password').value;
	
	var myHeaders = new Headers();
	myHeaders.append("SOAPAction", "\"\"");
	myHeaders.append("Content-Type", "application/json");
	
	var raw = `<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/">
	<Body>
	<login_details xmlns="http://main">
	<email>${email}</email>
	<pass>${password}</pass>
	</login_details>
	</Body>
	</Envelope>`;
	
	var requestOptions = {
	method: 'POST',
	headers: myHeaders,
	body: raw,
	redirect: 'follow'
	};
	
	fetch("http://localhost:8080/Wheels-project/services/Login", requestOptions)
	.then(response => response.text())
	.then(result => {
	console.log(result);
	var xml = parseXML(result);
	
	var UserIdNode = xml.getElementsByTagName("userid")[0];
	var EmailNode = xml.getElementsByTagName("email")[0];
	var PassNode = xml.getElementsByTagName("password")[0];
	
	var userId = UserIdNode ? UserIdNode.textContent : 'N/A';
	var email = EmailNode ? EmailNode.textContent : 'N/A';
	var pass = PassNode ? PassNode.textContent : 'N/A';
	
	if (email != 'N/A' && pass != 'N/A') {
	localStorage.setItem('ID', userId);
		document.getElementById('Login').remove();
		document.getElementById('HomePage').removeAttribute('hidden');
		document.getElementById('ShowCars').removeAttribute('hidden');
		//ShowCars();
	}
	else {
		alert("Error: No user found with the provided username and password.");
	}
	})
	.catch(error => console.log('error', error));
}

</script>
</html>